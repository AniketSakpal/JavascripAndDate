<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Javascript Practice Session</title>
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css"/>
</head>
<body>
    <br/><br/><br/>
    <div class="container">
        <div class="row">
            <div class="col-md-3">
                <div class="form-group">
                    <label for="formatDate">Date Formatter : </label>
                    <input type="text" class="form-control" id="formatDate" maxlength="10"/>
                    <span>
                        <span id="dateMessage" style="color: red;">
                            Practicing...
                        </span>
                    </span>
                </div>
            </div>
        </div>
    </div>


    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/popper.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script>
        $('#dateMessage').hide();
        var errorMessage = false;
        
        
        $('#formatDate').keypress(function(){
            dateFormatterOnKyPress(this,'DD/MM/YYYY');
        });

        $('#formatDate').on('input',function(){

            dateFormatOnInput(this,'DD/MM/YYYY');

        });

        function dateFormatterOnKyPress(element,format){
            var tempId = $(element).attr('id');
            var tempValue =  $(element).val();
            var positionMap = getIndexOfSeparator(format);
            /*var firstPosition =  ((positionMap.get('0'))+'').toString().split(',');
            console.log(firstPosition);*/
               if (tempValue.length == ((positionMap.get('0')).split(','))[0]){
                        
                    $('#'+tempId).val(tempValue+((positionMap.get('0')).split(','))[1]);
                    
               }
               if (tempValue.length == ((positionMap.get('1')).split(','))[0]){
                
                    $('#'+tempId).val(tempValue+((positionMap.get('0')).split(','))[1]);
               }               
        }

        function dateFormatOnInput(element,format){
            var tempValue = $(element).val();

               if (tempValue.length > 5 && (/^[0-9]*$/.test(tempValue))){
                    var positionMap = getIndexOfSeparator(format);        
                    appendValue = "";
                    for(var i=0; (i <= tempValue.length && appendValue.length <10); i++){
                        appendValue = appendValue+tempValue.substring(i,i+1);   
                        
                        if(appendValue.length == ((positionMap.get('0')).split(','))[0] ){
                            appendValue += ((positionMap.get('0')).split(','))[1];

                        }
                        
                        if (appendValue.length == ((positionMap.get('1')).split(','))[0] ){
                            appendValue += ((positionMap.get('0')).split(','))[1];
                        }
                    }
                    
                    $(element).val(appendValue);
               }
        }

        function getIndexOfSeparator(format){
                
                var tempFormat = "";
                var symbolCounter = 0;
                var symbolCounterMap = new Map();
                for(var i=0;i < format.length;i++){
                    tempFormat = format.substring(i,i+1);
                    if(tempFormat == "/" || tempFormat == "-"){
                        symbolCounterMap.set(''+symbolCounter+'',i+','+(tempFormat == "-" ? "-" : "/"));
                        symbolCounter++;
                    }
                }
                
            return symbolCounterMap;
        }

        

    </script>
</body>
</html>
